<ui:composition
	xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core">

	<h:outputScript library="js" name="tag-it.js"></h:outputScript>
	<h:outputStylesheet library="css" name="jquery.tagit.css"></h:outputStylesheet>
	<h:outputStylesheet library="css" name="tagit.ui-zendesk.css"></h:outputStylesheet>
	
	<script>
		
		function allActors(a) {
			$('#movieForm\\:actorName').tagit({
				availableTags: a,
				allowSpaces: true
			});
		}
	</script>

	<h:form id="movieForm">
		<h:panelGrid columns="1" width="600">
			#{msg.movieTitle}:
			<h:outputText value="#{movie.movieSelected.title}" rendered="#{not movie.editable}" />
			<h:inputText value="#{movie.movieEdit.title}" rendered="#{movie.editable}" />
			
			#{msg.movieReleaseDate}:
			<h:outputText value="#{movie.movieSelected.releaseDate.time}" rendered="#{not movie.editable}">
				<f:convertDateTime type="date" dateStyle="long" />
			</h:outputText>
			<h:inputText value="#{movie.movieEdit.releaseDate}" rendered="#{movie.editable}">
				<f:convertDateTime type="date" dateStyle="long" />
			</h:inputText>
			
			#{msg.movieActors}:
			<ui:repeat value="#{movie.movieSelected.actors}" var="actor">
				<h:outputText value="#{actor}" rendered="#{not movie.editable}" />
				<h:outputText value=" | " rendered="#{not movie.editable}" />
			</ui:repeat>
			
			<h:dataTable border="1" value="#{movie.movieEdit.actors}" var="a" 
						rendered="#{movie.editable}">
				<h:column>
					<h:outputText value="#{a}" />
				</h:column>
				<h:column>
					<h:commandLink value="#{msg.delete}" action="#{movie.deleteActor(a)}" />
				</h:column>
			</h:dataTable>
	
			<h:outputLabel for="actorName" value="#{msg.actorSelection}:" />
			<h:inputText id="actorName" value="#{movie.actorName}" 
							onfocus="allActors(#{movie.actorsString})" />
			<h:message for="actorName" style="color: red"></h:message>
			
			#{msg.movieStoryline}:
			<h:outputText value="#{movie.movieSelected.storyline}"></h:outputText>
	
			#{msg.movieGenres}:
			<ui:repeat var="genre" value="#{movie.movieSelected.genres}">
				#{genre} &#160;
			</ui:repeat>
				
			#{msg.movieTrailer}:
			<h:outputLink value="#{movie.movieSelected.trailerLocation}" rendered="#{movie.movieSelected.trailerLocationType == 2 and movie.movieSelected.trailerLocation != null}">
				<h:outputText value="#{msg.movieTrailerWatch}" /> 
			</h:outputLink>
			<video controls="controls"  style="display:#{(movie.movieSelected.trailerLocationType == 1)?'block':'none'}" >
				<source src="/trailers/#{movie.movieSelected.trailerLocation}" type="video/mp4" />
			</video>
			
			#{msg.movieRuntime}:
			<h:outputText value="#{movie.movieSelected.runtimeMinutes}"></h:outputText>
	
			#{msg.movieRate}:
			<h:outputText value="#{movie.movieSelected.rate}"></h:outputText>		
			
			<h:commandButton value="#{msg.delete}" action="#{movie.delete()}" rendered="#{not movie.editable}"/>
			<h:commandButton value="#{msg.edit}" action="#{movie.edit()}" rendered="#{not movie.editable}"/>
			<h:commandButton value="#{msg.save}" action="#{movie.save()}" rendered="#{movie.editable}" />
			<h:commandButton value="#{msg.cancel}" action="#{movie.cancel()}" rendered="#{movie.editable}" />
		</h:panelGrid>	
	</h:form>	
</ui:composition>
